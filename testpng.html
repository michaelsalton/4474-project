<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Animation with PNG Sequence</title>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="styles.css">
    <style>

        #cube {
            width: 100px; /* Adjust based on actual image size */
            height: 100px; /* Adjust based on actual image size */
            position: fixed;
            top: -100px;
            left: 50%;
            transform: translateX(-50%);
            transition: top 2s ease-out, left 0.5s ease-in-out 2s;
            z-index: 1000; /* Ensure it's rendered appropriately */
            display: none; /* Initially hidden */
        }

        .phone-wrapper {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        .phone {
            transition: background-color 0.5s ease;
            position: relative; /* For z-index context */
            z-index: 500; /* Lower than cube to render it behind the top bar */
        }

        .phone-header {
            z-index: 2; /* Ensures the header overlaps the cube */
            position: relative;
        }

        .control-buttons {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1100;
        }

        .control-buttons button {
            margin: 0 10px;
            padding: 10px 20px;
        }

        @keyframes flashGreen {
            from { background-color: green; }
            to { background-color: black; }
        }

        @keyframes flashRed {
            from { background-color: red; }
            to { background-color: black; }
        }

        @keyframes flashYellow {
            from { background-color: yellow; }
            to { background-color: black; }
        }

        .flashGreen {
            animation: flashGreen 0.5s forwards;
        }

        .flashRed {
            animation: flashRed 0.5s forwards;
        }

        .flashYellow {
            animation: flashYellow 0.5s forwards;
        }
    </style>
</head>
<body>

<img id="cube" src="" alt="Animated PNG">

<div class="phone-wrapper">
    <div class="phone">
        <div class="phone-header">
            <div class="battery"></div>
            <div class="network"></div>
            <div class="time" id="currentTime"></div>
        </div>
        <div class="bottom-bar">
            <button class="button">Search</button>
            <button class="button">My Tabs</button>
            <button class="button">Courses</button>
            <button class="button">Profile</button>
        </div>
    </div>
</div>

<!-- Directional Control Buttons -->
<div class="control-buttons">
    <button id="moveLeft">Incorrect Chord</button>
    <button id="moveRight">Correct Chord</button>
</div>

<script>
$(document).ready(function() {
    let playing = true;
    let isSlidingDown = true;
    let pngList = [
        '/Users/johnkrupa/Desktop/HCI Project/1.png',
        '/Users/johnkrupa/Desktop/HCI Project/2.png',
        '/Users/johnkrupa/Desktop/HCI Project/3.png',
        '/Users/johnkrupa/Desktop/HCI Project/1.png',
        '/Users/johnkrupa/Desktop/HCI Project/2.png',
        '/Users/johnkrupa/Desktop/HCI Project/3.png',
        '/Users/johnkrupa/Desktop/HCI Project/1.png',
        '/Users/johnkrupa/Desktop/HCI Project/2.png',
        '/Users/johnkrupa/Desktop/HCI Project/3.png',
        '/Users/johnkrupa/Desktop/HCI Project/1.png',
        '/Users/johnkrupa/Desktop/HCI Project/2.png',
        '/Users/johnkrupa/Desktop/HCI Project/3.png',
        '/Users/johnkrupa/Desktop/HCI Project/1.png',
        '/Users/johnkrupa/Desktop/HCI Project/2.png',
        '/Users/johnkrupa/Desktop/HCI Project/3.png',
    ];

    function animateCube() {
        if (pngList.length > 0) {
            let nextImage = pngList.shift();
            $('#cube').css({
                'top': '-100px',
                'left': '50%',
                'transition': 'none',
            }).show().attr('src', nextImage);

            isSlidingDown = true;

            setTimeout(() => {
                $('#cube').css({
                    'top': '50%',
                    'transition': 'top 2s ease-out',
                });
                setTimeout(() => isSlidingDown = false, 2100);
            }, 100);
        } else {
            playing = false;
            $('#cube').hide();
        }
    }

    $('#moveLeft').click(function() {
        flashAction('left');
    });

    $('#moveRight').click(function() {
        flashAction('right');
    });

    function flashAction(direction) {
        if (isSlidingDown) {
            // Flash screen based on direction and early press
            flashScreen(direction === 'left' ? 'flashRed' : 'flashYellow');
            $('#cube').hide(); // Hide cube immediately on early press
            setTimeout(() => {
                if (pngList.length > 0) {
                    animateCube(); // Respawn cube if there are remaining PNGs
                }
            }, 500); // Delay to allow for flash effect to complete
        } else {
            // If not sliding down, proceed with normal behavior
            moveCube(direction);
            flashScreen(direction === 'left' ? 'flashRed' : 'flashGreen');
        }
    }

    function moveCube(direction) {
        let newPos = direction === 'left' ? '0vw' : '100vw';
        $('#cube').css({
            'left': newPos,
            'transition': 'left 0.5s ease-in-out',
        });
        setTimeout(() => {
            if (pngList.length > 0) {
                animateCube(); // Only respawn cube if there are remaining PNGs
            } else {
                playing = false; // Stop the animation if no PNGs left
            }
        }, 500); // Wait for cube to move off screen before respawning
    }

    function flashScreen(colorClass) {
        const phone = $('.phone');
        phone.addClass(colorClass);
        setTimeout(() => phone.removeClass(colorClass), 500); // Duration of flash effect
    }

    function updateTime() {
        const now = new Date();
        const hours = now.getHours().toString().padStart(2, '0');
        const minutes = now.getMinutes().toString().padStart(2, '0');
        $('#currentTime').text(hours + ':' + minutes);
    }

    setInterval(updateTime, 1000); // Update time every second

    // Start the initial animation of the cube
    if (playing && pngList.length > 0) {
        animateCube();
    }
});
</script>

</body>
</html>